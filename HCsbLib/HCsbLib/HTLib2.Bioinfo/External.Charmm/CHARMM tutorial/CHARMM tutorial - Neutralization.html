<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<title>Neutralization - CHARMM tutorial</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.19.20+dfsg-0+deb7u3" />
<link rel="canonical" href="/index.php/Neutralization" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="CHARMM tutorial (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://www.charmmtutorial.org/api.php?action=rsd" />
<link rel="copyright" href="http://creativecommons.org/licenses/publicdomain/" />
<link rel="alternate" type="application/atom+xml" title="CHARMM tutorial Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="https://www.charmmtutorial.org/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cskins.monobook&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if IE 6]><link rel="stylesheet" href="/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="https://www.charmmtutorial.org/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}a.new,#quickbar a.new{color:#ba0000}

/* cache key: tutorial:resourceloader:filter:minify-css:7:c88e2bcd56513749bec09a7e29cb3ffa */</style>

<script src="https://www.charmmtutorial.org/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Neutralization","wgTitle":"Neutralization","wgCurRevisionId":774,"wgArticleId":51,"wgIsArticle":true,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgRelevantPageName":"Neutralization","wgRestrictionEdit":[],"wgRestrictionMove":[],"wgRedirectedFrom":"FINAL_Neutralization"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":
0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;},{},{});mw.loader.implement("user.tokens",function($){mw.user.tokens.set({"editToken":"+\\","watchToken":false});;},{},{});

/* cache key: tutorial:resourceloader:filter:minify-js:7:74a832f2292f1f4d40d425d223444e78 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Neutralization skin-monobook action-view">
<div id="globalWrapper">
<div id="column-content"><div id="content">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading"><span dir="auto">Neutralization</span></h1>
	<div id="bodyContent" class="mw-body">
		<div id="siteSub">From CHARMM tutorial</div>
		<div id="contentSub">(Redirected from <a href="/index.php?title=FINAL_Neutralization&amp;redirect=no" title="FINAL Neutralization">FINAL Neutralization</a>)</div>
		<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>
		<!-- start content -->
<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><h2> <span class="mw-headline" id="Description_of_Neutralization">Description of Neutralization</span></h2>
<p><a href="/index.php/File:Solvated-system2.png" class="image"><img alt="Solvated-system2.png" src="/images/c/ca/Solvated-system2.png" width="400" height="381" /></a>
</p><p>Some macromolecules may have an overall positive or negative charge instead of being neutral. The implementation of the Particle Mesh Ewald method (PME) for computing electrostatics that is present in CHARMM works most reliably when there is no net charge on the system. Therefore, when a molecule has a charge, it is generally thought best to cancel it out by adding counter ions to the solution. It is easy to detect when this needs to be done since when CHARMM reads in or modifies a PSF, it will output the total charge of the system as shown in the following sample output.
</p><p><a href="/index.php/File:Neut-output.png" class="image" title="Output of generate"><img alt="Output of generate" src="/images/4/47/Neut-output.png" width="639" height="166" /></a>
</p><p>The charge can also be calculated by printing out the <tt>?STOT</tt> variable after running the <tt>SCALar CHARge STAT</tt> command.
</p><p>Even if the system is neutral overall, it is often desirable to have an ion concentration since this more realistically mimics the interior of a cell or conditions in the blood stream. For example, it is known that cellular NaCL or KCL concentration is on the order of 0.15M and therefore, enough sodium or potassium and chloride ions will be added to both neutralize the system and set the correct concentration. However, adding charged particles close to a protein may influence its behavior in undesirable ways. Therefore, unless it is known that ions are found in close proximity to the macromolecule, they should be placed at some distance from it so that they are screened by the solvent.
</p>
<h2> <span class="mw-headline" id="Points_to_Consider_before_Neutralizing"> Points to Consider before Neutralizing </span></h2>
<p>There are a few things that need to be considered before you write a script to perform neutralization.
</p>
<ul><li> How many total counter-ions will be needed? Is there enough volume to accommodate them without getting too close to the solute?
</li><li> If you want to change the overall charge on the system (e.g. from +3 to 0) you will need different numbers of positive and negative ions (in this case, you would need 3 more negative ions than positive ones).
</li><li> Which ions should be used? CHARMM has parameters for a number of different salts.
</li><li> Are there any charged residues on the surface of the macromolecule that might be particularly disturbed in the presence of counter-ions?
</li><li> Conversely, are there any charged residues that might not behave correctly <b>without</b> a nearby counter-ion?
</li></ul>
<p>The example given in this tutorial describes a general procedure for neutralizing a system, however it does not consider too carefully the points mentioned above. You will need to understand the electrostatic and physical behavior of your system to know what concentration of ions is most appropriate.
</p>
<h2> <span class="mw-headline" id="General_Neutralization_Procedure"> General Neutralization Procedure </span></h2>
<p>The neutralization procedure implemented in CHARMMing is described below and uses a monte-carlo like method for picking a "good" configuration of ions in the solvent. The basic idea is that solvent waters are randomly replaced (with a few caveats) with ions. The system is then minimized briefly to remove bad contacts and the final energy is stored. This is repeated a certain number of times, and the minimized structure with the lowest total energy is chosen as the final neutralized system.
</p><p>A more detailed outline of the procedure is as follows:
</p>
<ol><li> User inputs the desired salt and concentration (it is assumed that the final charge will be 0) as well as the desired number of trials.
</li><li> Compute number of positive and negative counter-ions required to achieve the desired concentration and to make the system neutral.
</li><li> Create the positive and negative ion segments in CHARMM.
</li><li> Define all possible water molecules that could be replaced by this ion. These are all bulk waters that are not too close to the solvent or to another ion (CHARMMing uses a 5.5 Å cut-off).
</li><li> For each ion to be placed:
<ol><li> Delete a water molecule at random. and add the ion in its place
</li><li> Repeat until all ions required to reach the desired concentration have been added
</li></ol>
</li><li> Perform short minimization (100 steps of steepest descent)
</li><li> Check the energy versus the previous lowest energy conformation
</li><li> If current energy is lower then previous then save the structure and return to step 4
</li><li> Repeat until the desired number of trials have been run
</li></ol>
<p>Needless to say, some of these steps require some advanced magic with the <tt>SELEct</tt> command. A complete example of this is given <a href="/index.php/FINAL_Full_example" title="FINAL Full example" class="mw-redirect">later on in the tutorial</a>.
</p>
<!-- 
NewPP limit report
Preprocessor node count: 10/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key tutorial:pcache:idhash:51-0!*!0!!*!2!* and timestamp 20170915130006 -->
</div><div class="printfooter">
Retrieved from "<a href="https://www.charmmtutorial.org/index.php?title=Neutralization&amp;oldid=774">https://www.charmmtutorial.org/index.php?title=Neutralization&amp;oldid=774</a>"</div>
		<div id='catlinks' class='catlinks catlinks-allhidden'></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-main" class="selected"><a href="/index.php/Neutralization" primary="1" context="subject" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="/index.php?title=Talk:Neutralization&amp;action=edit&amp;redlink=1" primary="1" context="talk" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource"><a href="/index.php?title=Neutralization&amp;action=edit" primary="1" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="/index.php?title=Neutralization&amp;action=history" rel="archives" title="Past revisions of this page [h]" accesskey="h">History</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>

<li id="pt-login"><a href="/index.php?title=Special:UserLogin&amp;returnto=FINAL+Neutralization" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
<a href="/index.php/CHARMM_Tutorial" style="background-image: url(https://www.charmmtutorial.org/tutorial-data/image-sm.png);" title="Visit the main page"></a>
	</div>
	<div class="generated-sidebar portlet" id="p-CHARMM_Tutorial">
		<h5>CHARMM Tutorial</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="/index.php/CHARMM_Tutorial" title="Visit the main page [z]" accesskey="z">CHARMM Tutorial</a></li>
				<li id="n-Outline"><a href="/index.php/Outline">Outline</a></li>
				<li id="n-Introduction"><a href="/index.php/Introduction">Introduction</a></li>
				<li id="n-Basic-CHARMM-Scripting"><a href="/index.php/Basic_CHARMM_Scripting">Basic CHARMM Scripting</a></li>
				<li id="n-Essential-CHARMM-Features"><a href="/index.php/Essential_CHARMM_Features">Essential CHARMM Features</a></li>
				<li id="n-The-Energy-Function"><a href="/index.php/The_Energy_Function">The Energy Function</a></li>
				<li id="n-Minimization"><a href="/index.php/Minimization">Minimization</a></li>
				<li id="n-Solvation"><a href="/index.php/Solvation">Solvation</a></li>
				<li id="n-Neutralization"><a href="/index.php/Neutralization">Neutralization</a></li>
				<li id="n-Molecular-Dynamics"><a href="/index.php/MD">Molecular Dynamics</a></li>
				<li id="n-Langevin-Dynamics"><a href="/index.php/LD">Langevin Dynamics</a></li>
				<li id="n-Analysis"><a href="/index.php/Analysis">Analysis</a></li>
				<li id="n-Full-example"><a href="/index.php/Full_example">Full example</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-Appendices">
		<h5>Appendices</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Temperature-replica-exchange"><a href="/index.php/Temperature_replica_exchange">Temperature replica exchange</a></li>
				<li id="n-Coarse-Grained-Go-Models"><a href="/index.php/Coarse_Grained_Go_Models">Coarse Grained Go Models</a></li>
				<li id="n-CHARMMing.27s-PDB-reader"><a href="/index.php/CHARMMing%27s_PDB_Reader">CHARMMing's PDB reader</a></li>
				<li id="n-Installing-CHARMMing"><a href="/index.php/Installation_of_CHARMMing">Installing CHARMMing</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-SAR_and_QSAR">
		<h5>SAR and QSAR</h5>
		<div class='pBody'>
			<ul>
				<li id="n-SAR-and-QSAR-Introduction"><a href="/index.php/SAR_and_QSAR_Introduction">SAR and QSAR Introduction</a></li>
				<li id="n-SAR-Categorization-Lesson"><a href="/index.php/SAR_Categorization_Lesson">SAR Categorization Lesson</a></li>
				<li id="n-QSAR-Regression-Lesson"><a href="/index.php/QSAR_Regression_Lesson">QSAR Regression Lesson</a></li>
				<li id="n-Docking-Introduction-and-Walkthrough"><a href="/index.php/Docking_Introduction_and_Walkthrough">Docking Introduction and Walkthrough</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-Files">
		<h5>Files</h5>
		<div class='pBody'>
			<ul>
				<li id="n-This-tutorial-as-a-PDF"><a href="http://www.charmmtutorial.org/tutorial-data/charmm_tutorial_2010.pdf" rel="nofollow">This tutorial as a PDF</a></li>
				<li id="n-Tutorial-files-.28.tar.gz.29"><a href="http://www.charmmtutorial.org/tutorial-data/crambin_example.tar.gz" rel="nofollow">Tutorial files (.tar.gz)</a></li>
				<li id="n-Tutorial-files-.28.zip.29"><a href="http://www.charmmtutorial.org/tutorial-data/crambin_example.zip" rel="nofollow">Tutorial files (.zip)</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-Navigation">
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-recentchanges"><a href="/index.php/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-help"><a href="/index.php/Help:Contents" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/index.php" id="searchform">
				<input type='hidden' name="title" value="Special:Search"/>
				<input type="search" name="search" title="Search CHARMM tutorial [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Tools</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/index.php/Special:WhatLinksHere/Neutralization" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/index.php/Special:RecentChangesLinked/Neutralization" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
				<li id="t-specialpages"><a href="/index.php/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
				<li><a href="/index.php?title=Neutralization&amp;printable=yes" rel="alternate">Printable version</a></li>
				<li id="t-permalink"><a href="/index.php?title=Neutralization&amp;oldid=774" title="Permanent link to this revision of the page">Permanent link</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-copyrightico">
		<a href="http://creativecommons.org/licenses/publicdomain/"><img src="/skins/common/images/public-domain.png" alt="Public Domain" width="88" height="31" /></a>
	</div>
	<div id="f-poweredbyico">
		<a href="//www.mediawiki.org/"><img src="/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="lastmod"> This page was last modified on 20 July 2010, at 12:08.</li>
		<li id="viewcount">This page has been accessed 26,233 times.</li>
		<li id="copyright">Content is available under <a class="external" href="http://creativecommons.org/licenses/publicdomain/">Public Domain</a> unless otherwise noted.</li>
		<li id="privacy"><a href="/index.php/CHARMM_tutorial:Privacy_policy" title="CHARMM tutorial:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="/index.php/CHARMM_tutorial:About" title="CHARMM tutorial:About">About CHARMM tutorial</a></li>
		<li id="disclaimer"><a href="/index.php/CHARMM_tutorial:General_disclaimer" title="CHARMM tutorial:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready"], null, true);
}</script>
<script src="https://www.charmmtutorial.org/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<!-- Served in 0.165 secs. --></body></html>